// Smoke data configuration
const smokeData = {
  // Inferno Banana Smokes
  "inferno-banana-1": {
    position: "/Pic/inferno/inferno_1.jpg",
    throw: "/Pic/inferno/inferno_1_1.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.6%", left: "50%" },
    instructions: "Spawn 1<br/>Jump",
  },
  "inferno-banana-2": {
    position: "/Pic/inferno/inferno_2.jpg",
    throw: "/Pic/inferno/inferno_2_2.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "51%", left: "43.8%" },
    instructions: "Spawn 2<br/>Jump",
  },
  "inferno-banana-3": {
    position: "/Pic/inferno/inferno_3.jpg",
    throw: "/Pic/inferno/inferno_3_3.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "74.5%", left: "50%" },
    instructions: "Spawn 3<br/>Jump",
  },
  "inferno-banana-4": {
    position: "/Pic/inferno/inferno_4.jpg",
    throw: "/Pic/inferno/inferno_4_4.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.6%", left: "50%" },
    instructions: "Spawn 4<br/>Jump",
  },
  "inferno-banana-5": {
    position: "/Pic/inferno/inferno_5.jpg",
    throw: "/Pic/inferno/inferno_5_5.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "50%" },
    instructions: "Spawn 5<br/>Jump",
  },
  "inferno-banana-6": {
    position: "/Pic/inferno/inferno_6.jpg",
    throw: "/Pic/inferno/inferno_6_6.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.6%", left: "50%" },
    instructions: "Spawn 6<br/>Jump",
  },

  // Inferno Mid Smokes
  "inferno-mid-1": {
    position: "/Pic/inferno/inferno_1.jpg",
    throw: "/Pic/inferno/inferno_1_1_1.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "50%" },
    instructions: "Spawn 1<br/>W + Jump",
  },
  "inferno-mid-2": {
    position: "/Pic/inferno/inferno_2.jpg",
    throw: "/Pic/inferno/inferno_2_2_2.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "50%" },
    instructions: "Spawn 2<br/>W + Jump",
  },
  "inferno-mid-3": {
    position: "/Pic/inferno/inferno_3.jpg",
    throw: "/Pic/inferno/inferno_3_3_3.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.5%", left: "50%" },
    instructions: "Spawn 3<br/>W + Jump",
  },
  "inferno-mid-4": {
    position: "/Pic/inferno/inferno_4.jpg",
    throw: "/Pic/inferno/inferno_4_4_4.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "74%", left: "50%" },
    instructions: "Spawn 4<br/>Jump",
  },
  "inferno-mid-5": {
    position: "/Pic/inferno/inferno_5.jpg",
    throw: "/Pic/inferno/inferno_5_5_5.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.7%", left: "50%" },
    instructions: "Spawn 5<br/>Jump",
  },
  "inferno-mid-6": {
    position: "/Pic/inferno/inferno_6.jpg",
    throw: "/Pic/inferno/inferno_6_6_6.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "56.5%" },
    instructions: "Spawn 6<br/>Jump",
  },

  // Nuke Outside Smokes
  "nuke-outside-1": {
    position: "/Pic/nuke/nuke_1.jpg",
    throw: "/Pic/nuke/Nuke1_1.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "50%" },
    instructions: "Spawn 1<br/>Jump",
  },
  "nuke-outside-2": {
    position: "/Pic/nuke/nuke_2.jpg",
    throw: "/Pic/nuke/nuke_2_2.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.5%", left: "50%" },
    instructions: "Spawn 2<br/>W + Jump",
  },
  "nuke-outside-3": {
    position: "/Pic/nuke/nuke_3.jpg",
    throw: "/Pic/nuke/nuke_3_3.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.5%", left: "50%" },
    instructions: "Spawn 3<br/>W + Jump",
  },
  "nuke-outside-4": {
    position: "/Pic/nuke/nuke_4.jpg",
    throw: "/Pic/nuke/nuke_4_4.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "50%" },
    instructions: "Spawn 4<br/>W + Jump",
  },
  "nuke-outside-5": {
    position: "/Pic/nuke/nuke_5.jpg",
    throw: "/Pic/nuke/nuke_5_5.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "50%" },
    instructions: "Spawn 5<br/>W + Jump",
  },
  "nuke-outside-6": {
    position: "/Pic/nuke/nuke_6.jpg",
    throw: "/Pic/nuke/nuke_6_6.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.6%", left: "50%" },
    instructions: "Spawn 6<br/>W + Jump",
  },
  "nuke-outside-7": {
    position: "/Pic/nuke/nuke_7.jpg",
    throw: "/Pic/nuke/nuke_7_7.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.6%", left: "50%" },
    instructions: "Spawn 7<br/>W + Jump",
  },
  "nuke-outside-8": {
    position: "/Pic/nuke/nuke_8.jpg",
    throw: "/Pic/nuke/nuke_8_8.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.6%", left: "50%" },
    instructions: "Spawn 8<br/>W + Jump",
  },

  // Nuke Other Smokes
  "nuke-other-1": {
    position: "/Pic/nuke/nuke_9.jpg",
    throw: "/Pic/nuke/nuke_9_9.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "50%" },
    instructions: "Outside 1<br/>Jump",
  },
  "nuke-other-2": {
    position: "/Pic/nuke/nuke_10.jpg",
    throw: "/Pic/nuke/nuke_10_10.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "43.5%" },
    instructions: "Outside 2<br/>Jump",
  },
  "nuke-other-3": {
    position: "/Pic/nuke/nuke_11.jpg",
    throw: "/Pic/nuke/nuke_11_11.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "61.5%", left: "50%" },
    instructions: "A Main Smoke<br/>Ctrl MID + Jump",
  },
  "nuke-fire-1": {
    position: "/Pic/nuke/nuke_fire_1.jpg",
    throw: "/Pic/nuke/nuke_fire_1_1.jpg",
    positionCircle: { top: "50%", left: "50%" },
    throwCircle: { top: "50%", left: "50%" },
    instructions: "Fire HUT<br/>Ctrl + Jump",
  },
};

// DOM Elements
let modal, modalContent, closeBtn;
let modalPositionImg, modalThrowImg;
let modalPositionCircle, modalThrowCircle;
let modalInstructions;

// Initialize application
document.addEventListener("DOMContentLoaded", function () {
  initializeModal();
  initializePositionItems();
  initializeSmoothScrolling();

  console.log("CS Smoke Guide initialized");
});

// Initialize modal functionality
function initializeModal() {
  modal = document.getElementById("smoke-detail-modal");
  closeBtn = modal.querySelector(".close");
  modalPositionImg = document.getElementById("modal-position-img");
  modalThrowImg = document.getElementById("modal-throw-img");
  modalPositionCircle = document.getElementById("modal-position-circle");
  modalThrowCircle = document.getElementById("modal-throw-circle");
  modalInstructions = document.getElementById("modal-instructions");

  // Close modal events
  closeBtn.addEventListener("click", closeModal);
  modal.addEventListener("click", function (e) {
    if (e.target === modal) {
      closeModal();
    }
  });

  // Close modal on Escape key
  document.addEventListener("keydown", function (e) {
    if (e.key === "Escape" && modal.classList.contains("show")) {
      closeModal();
    }
  });
}

// Initialize position items click handlers
function initializePositionItems() {
  const positionItems = document.querySelectorAll(".position-item");

  positionItems.forEach((item) => {
    item.addEventListener("click", function () {
      const smokeId = this.getAttribute("data-smoke");
      openSmokeDetail(smokeId);

      // Add active state
      positionItems.forEach((i) => i.classList.remove("active"));
      this.classList.add("active");
    });

    // Add hover effects
    item.addEventListener("mouseenter", function () {
      this.style.transform = "translateY(-8px) scale(1.02)";
    });

    item.addEventListener("mouseleave", function () {
      if (!this.classList.contains("active")) {
        this.style.transform = "";
      }
    });
  });
}

// Open smoke detail modal
function openSmokeDetail(smokeId) {
  const smokeInfo = smokeData[smokeId];

  if (!smokeInfo) {
    console.error("Smoke data not found for:", smokeId);
    return;
  }

  // Set images
  modalPositionImg.src = smokeInfo.position;
  modalThrowImg.src = smokeInfo.throw;

  // Set circle positions
  setCirclePosition(modalPositionCircle, smokeInfo.positionCircle);
  setCirclePosition(modalThrowCircle, smokeInfo.throwCircle);

  // Set instructions
  modalInstructions.innerHTML = smokeInfo.instructions;

  // Show modal
  modal.classList.add("show");
  document.body.style.overflow = "hidden";

  console.log("Opened smoke detail for:", smokeId);
}

// Close modal
function closeModal() {
  modal.classList.remove("show");
  document.body.style.overflow = "";

  // Remove active states
  const activeItems = document.querySelectorAll(".position-item.active");
  activeItems.forEach((item) => {
    item.classList.remove("active");
    item.style.transform = "";
  });

  console.log("Modal closed");
}

// Set circle position
function setCirclePosition(circle, position) {
  circle.style.top = position.top;
  circle.style.left = position.left;
}

// Initialize smooth scrolling for navigation links
function initializeSmoothScrolling() {
  const navLinks = document.querySelectorAll(".nav-links a");

  navLinks.forEach((link) => {
    link.addEventListener("click", function (e) {
      const href = this.getAttribute("href");

      if (href.startsWith("#")) {
        e.preventDefault();

        const targetId = href.substring(1);
        const targetElement = document.getElementById(targetId);

        if (targetElement) {
          const headerHeight = 120;
          const targetPosition = targetElement.offsetTop - headerHeight;

          window.scrollTo({
            top: targetPosition,
            behavior: "smooth",
          });

          // Update active navigation
          updateActiveNavigation(targetId);
        }
      }
    });
  });
}

// Update active navigation item
function updateActiveNavigation(activeId) {
  const navLinks = document.querySelectorAll(".nav-links a");

  navLinks.forEach((link) => {
    const href = link.getAttribute("href");
    if (href === `#${activeId}`) {
      link.style.color = "#ff6b35";
      link.style.backgroundColor = "rgba(255, 107, 53, 0.1)";
    } else {
      link.style.color = "";
      link.style.backgroundColor = "";
    }
  });

  // Reset after 3 seconds
  setTimeout(() => {
    navLinks.forEach((link) => {
      link.style.color = "";
      link.style.backgroundColor = "";
    });
  }, 3000);
}

// Handle image loading errors
function handleImageError(img) {
  img.style.display = "none";
  console.error("Failed to load image:", img.src);
}

// Add error handling for all images
document.addEventListener("DOMContentLoaded", function () {
  const images = document.querySelectorAll("img");
  images.forEach((img) => {
    img.addEventListener("error", function () {
      handleImageError(this);
    });
  });
});

// Scroll to top functionality
function scrollToTop() {
  window.scrollTo({
    top: 0,
    behavior: "smooth",
  });
}

// Add scroll to top button (optional)
function addScrollToTopButton() {
  const scrollBtn = document.createElement("button");
  scrollBtn.innerHTML = "↑";
  scrollBtn.className = "scroll-to-top";
  scrollBtn.style.cssText = `
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        border: none;
        border-radius: 50%;
        background-color: #ff6b35;
        color: white;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
    `;

  scrollBtn.addEventListener("click", scrollToTop);
  document.body.appendChild(scrollBtn);

  // Show/hide on scroll
  window.addEventListener("scroll", function () {
    if (window.pageYOffset > 300) {
      scrollBtn.style.opacity = "1";
      scrollBtn.style.visibility = "visible";
    } else {
      scrollBtn.style.opacity = "0";
      scrollBtn.style.visibility = "hidden";
    }
  });
}

// Initialize scroll to top button
document.addEventListener("DOMContentLoaded", function () {
  setTimeout(addScrollToTopButton, 1000);
});

// Performance optimization: Lazy loading for images
function initializeLazyLoading() {
  if ("IntersectionObserver" in window) {
    const imageObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const img = entry.target;
          const src = img.getAttribute("data-src");
          if (src) {
            img.src = src;
            img.removeAttribute("data-src");
          }
          observer.unobserve(img);
        }
      });
    });

    const lazyImages = document.querySelectorAll("img[data-src]");
    lazyImages.forEach((img) => imageObserver.observe(img));
  }
}

// Utility function: Debounce
function debounce(func, wait, immediate) {
  let timeout;
  return function executedFunction() {
    const context = this;
    const args = arguments;
    const later = function () {
      timeout = null;
      if (!immediate) func.apply(context, args);
    };
    const callNow = immediate && !timeout;
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
    if (callNow) func.apply(context, args);
  };
}

// Handle window resize
window.addEventListener(
  "resize",
  debounce(function () {
    // Recalculate any responsive elements if needed
    console.log("Window resized");
  }, 250)
);

// Console welcome message
console.log(`
🎮 CS Smoke Guide loaded successfully!
🔧 Version: 2.0
📧 Support: https://github.com/your-repo
`);
